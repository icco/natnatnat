var videoUrlRe=/https?:\/\/(www\.)?(youtu|vimeo|soundcloud).+/i,defaults={key:"be853af8968a408eb7ec368d2019614a",query:{maxwidth:Math.min($(window).width(),720),words:20},secure:!0,method:$.noop,urlRe:videoUrlRe};$.embedly.defaults=defaults,$(".markdown a").each(function(e,t){var i=$(t).attr("href");$.embedly.oembed([i]).done(function(e){var r=$("<div/>",{class:"embed pure-u-1",data:i});if(!e[0].error){void 0!=e[0].html?(r.append(e[0].html),r.removeClass("embed")):(title=$("<h1/>").append(e[0].title),desc=$("<p/>").append(e[0].description),r.append(title),r.append(desc));var n=$(t).parents(".post").children(".addons");n.append(r)}})});var formHasChanged=!1,submitted=!1;$("input, select, textarea").bind("input propertychange",function(){formHasChanged=!0}),window.onbeforeunload=function(e){if(formHasChanged&&!submitted){var t="You have not saved your changes.",e=e||window.event;return e&&(e.returnValue=t),t}},$("form").submit(function(){submitted=!0}),module.exports=function(e){var t={key:null,endpoint:"oembed",secure:null,query:{},method:"replace",addImageStyles:!0,wrapElement:"div",className:"embed",batch:20,urlRe:null},i=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,r=function(e){return null===e||void 0===e},n=function(t,i){var r=[],n=[];return e.each(t,function(e,t){n.push(t),n.length===i&&(r.push(n),n=[])}),0!==n.length&&r.push(n),r},o=function(t){return r(t)?[]:e.isArray(t)?t:[t]},s=function(t){return e.map(t[0],function(i,r){return[e.map(t,function(e){return e[r]})]})},a=function(e,t,i){this.init(e,t,i)};a.prototype={init:function(t){this.urls=t,this.count=0,this.results={},this._deferred=e.Deferred()},notify:function(t){if(this.results[t.original_url]=t,this.count++,this._deferred.notify.apply(this._deferred,[t]),this.count===this.urls.length){var i=this,r=e.map(this.urls,function(e){return i.results[e]});this._deferred.resolve(r)}return this},state:function(){return this._deferred.state.apply(this._deferred,arguments)}},window.Keeper=a;var l=function(){};l.prototype={defaults:{},log:function(e,t){r(window.console)||r(window.console[e])||window.console[e].apply(window.console,[t])},build:function(t,i,n){n=r(n)?{}:n;var o=n.secure;r(o)&&(o="https:"===window.location.protocol);var s=(o?"https":"http")+"://api.embed.ly/"+("objectify"===t?"2/":"1/")+t,a=r(n.query)?{}:n.query;return a.key=n.key,s+="?"+e.param(a),s+="&urls="+e.map(i,encodeURIComponent).join(",")},ajax:function(l,d,u){if(u=e.extend({},t,e.embedly.defaults,"object"==typeof u&&u),r(u.key))return this.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly"),null;d=o(d);var h,p=new a(d),c=[],f=[];e.each(d,function(e,t){h=!1,i.test(t)&&(h=!0,null!==u.urlRe&&u.urlRe.test&&!u.urlRe.test(t)&&(h=!1)),h===!0?c.push(t):f.push({url:t,original_url:t,error:!0,invalid:!0,type:"error",error_message:'Invalid URL "'+t+'"'})});var m=n(c,u.batch),y=this;return e.each(m,function(t,i){e.ajax({url:y.build(l,i,u),dataType:"jsonp",success:function(t){e.each(s([i,t]),function(e,t){var i=t[1];i.original_url=t[0],i.invalid=!1,p.notify(i)})}})}),f.length&&setTimeout(function(){e.each(f,function(e,t){p.notify(t)})},1),p._deferred},oembed:function(e,t){return this.ajax("oembed",e,t)},preview:function(e,t){return this.ajax("preview",e,t)},objectify:function(e,t){return this.ajax("objectify",e,t)},extract:function(e,t){return this.ajax("extract",e,t)}};var d=function(){};d.prototype={build:function(t,i,n){n=e.extend({},e.embedly.defaults,"object"==typeof n&&n);var o=n.secure;r(o)&&(o="https:"===window.location.protocol);var s=(o?"https":"http")+"://i.embed.ly/"+("display"===t?"1/":"1/display/")+t,a=r(n.query)?{}:n.query;return a.key=n.key,s+="?"+e.param(a),s+="&url="+encodeURIComponent(i)},display:function(e,t){return this.build("display",e,t)},resize:function(e,t){return this.build("resize",e,t)},fill:function(e,t){return this.build("fill",e,t)},crop:function(e,t){return this.build("crop",e,t)}};var u=function(e,t,i){this.init(e,t,i)};u.prototype={init:function(t,i,r){this.elem=t,this.$elem=e(t),this.original_url=i,this.options=r,this.loaded=e.Deferred();var n=this;this.loaded.done(function(){n.$elem.trigger("loaded",[n])}),this.$elem.trigger("initialized",[this])},progress:function(t){e.extend(this,t),this.options.display?this.options.display.apply(this.elem,[this,this.elem]):"oembed"===this.options.endpoint&&this.display(),this.loaded.resolve(this)},imageStyle:function(){var e,t=[];return this.options.addImageStyles&&(this.options.query.maxwidth&&(e=isNaN(parseInt(this.options.query.maxwidth,10))?"":"px",t.push("max-width: "+this.options.query.maxwidth+e)),this.options.query.maxheight&&(e=isNaN(parseInt(this.options.query.maxheight,10))?"":"px",t.push("max-height: "+this.options.query.maxheight+e))),t.join(";")},display:function(){if("error"===this.type)return!1;this.style=this.imageStyle();var e;"photo"===this.type?(e="<a href='"+this.original_url+"' target='_blank'>",e+="<img style='"+this.style+"' src='"+this.url+"' alt='"+this.title+"' /></a>"):"video"===this.type||"rich"===this.type?e=this.html:(this.title=this.title||this.url,e=this.thumbnail_url?"<img src='"+this.thumbnail_url+"' class='thumb' style='"+this.style+"'/>":"",e+="<a href='"+this.original_url+"'>"+this.title+"</a>",e+=this.provider_name?"<a href='"+this.provider_url+"' class='provider'>"+this.provider_name+"</a>":"",e+=this.description?'<div class="description">'+this.description+"</div>":""),this.options.wrapElement&&(e="<"+this.options.wrapElement+' class="'+this.options.className+'">'+e+"</"+this.options.wrapElement+">"),this.code=e,"replace"===this.options.method?this.$elem.replaceWith(this.code):"after"===this.options.method?this.$elem.after(this.code):"afterParent"===this.options.method?this.$elem.parent().after(this.code):"replaceParent"===this.options.method&&this.$elem.parent().replaceWith(this.code),this.$elem.trigger("displayed",[this])}},e.embedly=new l,e.embedly.display=new d,e.fn.embedly=function(i){if(void 0===i||"object"==typeof i){if(i=e.extend({},t,e.embedly.defaults,"object"==typeof i&&i),r(i.key))return e.embedly.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly"),this.each(e.noop);var n={},o=function(t){if(!e.data(e(t),"embedly")){var r=e(t).attr("href"),o=new u(t,r,i);e.data(t,"embedly",o),n.hasOwnProperty(r)?n[r].push(o):n[r]=[o]}},s=this.each(function(){r(e(this).attr("href"))?e(this).find("a").each(function(){r(e(this).attr("href"))||o(this)}):o(this)}),a=e.embedly.ajax(i.endpoint,e.map(n,function(e,t){return t}),i).progress(function(t){e.each(n[t.original_url],function(e,i){i.progress(t)})});return i.progress&&a.progress(i.progress),i.done&&a.done(i.done),s}},e.expr[":"].embedly=function(t){return!r(e(t).data("embedly"))},e.fn.display=function(i,n){if(r(i)&&(i="display"),void 0===n||"object"==typeof n){if(n=e.extend({},t,e.embedly.defaults,"object"==typeof n&&n),r(n.key))return e.embedly.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly/display"),this.each(e.noop);var o=function(t){var r=e(t);if(!r.data("display")){var o=r.data("src")||r.attr("href"),s={original_url:o,url:e.embedly.display.build(i,o,n)};r.data("display",s),r.trigger("initialized",[t]);var a="<img src='"+s.url+"' />";r.is("a")?r.append(a):r.replaceWith(a)}},s=function(t){return!r(e(t).data("src"))||!r(e(t).attr("href"))},a=this.each(function(){s(this)?o(this):e(this).find("img,a").each(function(){s(this)&&o(this)})});return a}},e.expr[":"].display=function(t){return!r(e(t).data("display"))}};var LinkAdder=function(){var e=require("jquery");e("li.link").each(function(t,i){e(i).children("a.adder").click(function(){link=e(i).children("a.actual")[0],title=e(link).text(),tags=e(this).data("tags"),url=e(link).attr("href"),mkd="\n["+title+"]("+url+")\n\n"+tags,ta=e('textarea[name="text"]'),ta.val(ta.val()+mkd)})})};module.exports=LinkAdder;var MarkdownPreview=function(){var e=require("jquery"),t="textarea[name=text]";e(t).length&&e(t).bind("input propertychange",function(){e.post("/md",{text:e(this).val()},function(t){e("#rendered").html(t)})});var i="input[name=title]";e(i).length&&e(i).bind("input propertychange",function(){e("#rendered_title").text(e(i).val())}),e(".slidingDiv").hide(),e(".show_hide").click(function(){e("#rendered").slideToggle()})};module.exports=MarkdownPreview;var RelativeTimes=function(){var e=require("jquery"),t=require("moment");e("time").each(function(i,r){var n=t(e(r).attr("datetime"),"YYYY-MM-DDTHH:mm:ss.SSSSSSZ");e(r).text(n.fromNow()),e(r).attr("title",n.format())}),e("#links h2").each(function(i,r){var n=t(e(r).text(),"YYYY-MM-DD HH:mm:ssZ");e(r).text(n.utc().format("MMMM Do YYYY"))})};module.exports=RelativeTimes;
//# sourceMappingURL=public/js/nat.min.js.map